;;;;;
title: E-mails on Wordpress
tags: Linux
date: 2008-03-05 04:54:12
format: html
;;;;;
<p>For those who don't know, <a href="http://www.wordpress.org/">Wordpress</a> is the blogging software I run on <a href="http://www.redlinernotes.com/">my server</a>. Whenever a comment is left though if it passes through my spam filters it goes to a moderation queue to be approved by me. This is practical for two reasons: 1) In spite of my spam filter (<a href="http://en.wikipedia.org/wiki/Akismet">Akismet</a>) being competent, it's not perfect and stuff still slips through. 2) I have low enough traffic that I can keep up with the moderation queue pretty closely.</p><br><p>However, until today there was a drawback to this. Wordpress is supposed to send out e-mails for various reasons but it never worked and the reason is that the program it needed to send mail (called sendmail, cleverly enough) I didn't install by default with Ubuntu 6.06 Server (now upgraded to 8.04). </p><br><p>Now, <a href="http://en.wikipedia.org/wiki/Sendmail">sendmail</a> is not a mail client like Outlook, Thunderbird, or iMail. It's a <a href="http://en.wikipedia.org/wiki/Mail_transfer_agent">MTA</a> (Mail Transfer Agent) and frankly I have no desire to run an MTA on my server. That's overkill and it's just one more thing that can get hacked. So today, I did two things. 1) Set up ssmtp as an alternative that pushes everything to my gmail account. 2) Installed a plugin so I get notifications whenever a comment is in the moderation queue and the user gets an e-mail letting them know too.</p><br><p>Here's how I did it:<br /><br>For the debian-based kids, try running:</p><br><pre><br>sudo apt-get install ssmtp</pre><br><p>After that completes, you're going to want to:</p><br><pre><br>sudo nano /etc/ssmtp/ssmtp.conf</pre><br><p>There are six values you'll want to change in here and they should look like the following:<br /><br><br>mailhub=smtp.gmail.com:587<br>AuthUser=youremail@gmail.com<br>AuthPass=pass<br>UseSTARTTLS=YES<br>hostname=machinehostname<br>FromLineOverride=YES</p><br><p>From there you'll want to hit Ctrl-O Ctrl-X to save and exit. After that you'll need to tell your php configuration to use ssmtp instead of the default (sendmail). So type:</p><br><pre><br>sudo nano /etc/php5/apache2/php.ini</pre><br><p>and hit Ctrl-W, then type sendmail and hit enter to search for sendmail in the document. You should find something called sendmail_path, modify it to look like:<br /><br><code>sendmail_path = /usr/sbin/ssmtp -t -i -au username -ap password -am LOGIN</code></p><br><p>Restart your Apache server to take advantage of the changes by typing:</p><br><pre><br>sudo /etc/init.d/apache2 restart</pre><br><p>Finally, download <a href="http://weblogtoolscollection.com/b2-img/2007/03/modnotifyauthor.zip">this</a> to your server and unzip it into /wordpress_root/wp-content/plugins and activate it in the plugins menu. That's it!</p><br><p>References:<br /><br><a href="http://www.igvita.com/2007/08/29/ssmtp-relay-mail-delivery-in-rails/">SSMTP Gmail Guide</a><br /><br><a href="http://www.davidhurst.co.uk/2007/06/19/php-mail-and-ssmtp-on-debian-linux/">SSMTP Guide for PHP on Debian/Ubuntu</a><br /><br><a href="http://weblogtoolscollection.com/archives/2007/03/15/wp-plugin-notify-author-on-comment-moderation/">Wordpress Plugin</a></p>
